# Netlify configuration for Video Downloader
# Frontend deployment with backend API integration

[build]
  publish = "frontend"
  # Generate env.js file with API URL at build time
  command = "bash -lc \"mkdir -p frontend && echo \\\"window.__API_URL__='${VITE_API_URL:-http://localhost:8000}'\\\" > frontend/env.js\""

# SPA routing: redirect all requests to index.html
[[redirects]]
  from = "/*"
  to = "/index.html"
  status = 200

# Cache control headers
[[headers]]
  for = "/*"
  [headers.values]
    Cache-Control = "public, max-age=3600"

[[headers]]
  for = "/index.html"
  [headers.values]
    Cache-Control = "no-cache, no-store, must-revalidate"

# Production environment
[context.production.environment]
  # Update this with your backend API URL after deployment
  VITE_API_URL = "https://your-backend-service-url.com"

# Branch deploys
[context.branch-deploy.environment]
  VITE_API_URL = "http://localhost:8000"

# Deploy previews
[context.deploy-preview.environment]
  VITE_API_URL = "http://localhost:8000"

